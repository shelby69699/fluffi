<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FluffFi Staking - Stake Your $FLUFF on Cardano</title>
    <meta name="description" content="Stake your FluffFi tokens and earn rewards! Join the fluffiest staking revolution on Cardano blockchain.">
    <meta name="author" content="FluffFi Team">
    <link rel="icon" href="images/3ed7b15d-65d7-4b9f-b73f-a3923e3817a4.png" type="image/png">

    <meta property="og:title" content="FluffFi Staking - Stake Your $FLUFF Tokens">
    <meta property="og:description" content="Stake your FluffFi tokens and earn rewards! 🦊 Join the fluffiest staking revolution on Cardano blockchain.">
    <meta property="og:type" content="website">
    <meta property="og:image" content="images/3ed7b15d-65d7-4b9f-b73f-a3923e3817a4.png">
    <meta property="og:url" content="https://shelby69699.github.io/fluffi/">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="FluffFi Staking - Stake Your $FLUFF Tokens">
    <meta name="twitter:description" content="Stake your FluffFi tokens and earn rewards! 🦊 Join the fluffiest staking revolution on Cardano.">
    <meta name="twitter:image" content="images/3ed7b15d-65d7-4b9f-b73f-a3923e3817a4.png">
    <script type="module" crossorigin="" src="js/index-DLdXciP5.js"></script>
    <link rel="stylesheet" crossorigin="" href="css/index-C3j-O4ze.css">
</head>

<body>
    <div id="root"></div>
    
    <!-- Wallet Connector Section -->
    <div id="wallet-connector" style="position: fixed; top: 20px; right: 20px; z-index: 1000; background: rgba(255,255,255,0.95); padding: 15px; border-radius: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); max-width: 300px;">
        <button id="connect-btn" style="background: linear-gradient(135deg, #f56500, #ff8c00); color: white; border: none; padding: 12px 24px; border-radius: 8px; font-weight: 600; cursor: pointer; width: 100%; transition: all 0.3s ease;">
            🦊 Connect Eternal Wallet
        </button>
        <p id="wallet-address" style="margin-top: 10px; font-size: 12px; color: #666; word-break: break-all;"></p>
        
        <!-- Staking Interface (shown after wallet connection) -->
        <div id="staking-interface" style="display: none; margin-top: 15px; padding-top: 15px; border-top: 1px solid #eee;">
            <h4 style="color: #f56500; margin-bottom: 10px;">🏦 Stake Your $FLUFF</h4>
            <div style="margin-bottom: 10px;">
                <label style="display: block; font-size: 12px; color: #666; margin-bottom: 5px;">Amount to Stake:</label>
                <input type="number" id="stake-amount" placeholder="Enter FLUFF amount" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 5px; font-size: 14px;">
            </div>
            <button id="stake-btn" style="background: #8b5cf6; color: white; border: none; padding: 8px 16px; border-radius: 5px; font-weight: 600; cursor: pointer; width: 100%; margin-bottom: 8px;">
                🚀 Stake Tokens
            </button>
            <button id="unstake-btn" style="background: #dc2626; color: white; border: none; padding: 8px 16px; border-radius: 5px; font-weight: 600; cursor: pointer; width: 100%;">
                💰 Unstake Tokens
            </button>
            <div id="staking-info" style="margin-top: 10px; font-size: 12px; color: #666;">
                <p>💎 Staked: <span id="staked-amount">0</span> FLUFF</p>
                <p>🎁 Rewards: <span id="rewards-amount">0</span> FLUFF</p>
                <p>📈 APY: <span style="color: #f56500; font-weight: bold;">69%</span></p>
            </div>
        </div>
    </div>
    
    <!-- IMPORTANT: DO NOT REMOVE THIS SCRIPT TAG OR THIS VERY COMMENT! -->
    <script src="js/gptengineer.js" type="module"></script>

    <!-- Wallet Connection and Staking JavaScript -->
    <script>
        const connectBtn = document.getElementById("connect-btn");
        const walletAddressDisplay = document.getElementById("wallet-address");
        const stakingInterface = document.getElementById("staking-interface");
        const stakeBtn = document.getElementById("stake-btn");
        const unstakeBtn = document.getElementById("unstake-btn");
        const stakeAmountInput = document.getElementById("stake-amount");
        const stakedAmountDisplay = document.getElementById("staked-amount");
        const rewardsAmountDisplay = document.getElementById("rewards-amount");

        let isWalletConnected = false;
        let walletApi = null;
        let stakedAmount = 0;
        let rewardsAmount = 0;

        async function connectWallet() {
            if (!window.cardano || !window.cardano.eternl) {
                alert("🦊 Eternal wallet not found! Please install it from eternalwallet.io to start staking your FLUFF tokens.");
                return;
            }

            try {
                // Enable the wallet
                walletApi = await window.cardano.eternl.enable();
                const addresses = await walletApi.getUsedAddresses();
                
                if (addresses.length > 0) {
                    const firstAddress = addresses[0];
                    const shortAddress = firstAddress.substring(0, 12) + "..." + firstAddress.substring(firstAddress.length - 8);
                    
                    walletAddressDisplay.innerHTML = `🔗 Connected: <strong>${shortAddress}</strong>`;
                    connectBtn.textContent = "✅ Wallet Connected";
                    connectBtn.style.background = "#10b981";
                    connectBtn.disabled = true;
                    
                    // Show staking interface
                    stakingInterface.style.display = "block";
                    isWalletConnected = true;
                    
                    // Simulate loading existing staking data
                    loadStakingData();
                    
                    console.log("🦊 FluffFi Staking: Wallet connected successfully!");
                } else {
                    throw new Error("No addresses found in wallet");
                }
            } catch (err) {
                console.error("Wallet connection failed:", err);
                walletAddressDisplay.innerHTML = `❌ Failed to connect wallet. Please try again.`;
                walletAddressDisplay.style.color = "#dc2626";
            }
        }

        function loadStakingData() {
            // Simulate loading staking data from blockchain
            // In a real implementation, this would query the actual staking contract
            const savedStaking = localStorage.getItem('fluffi-staking');
            if (savedStaking) {
                const stakingData = JSON.parse(savedStaking);
                stakedAmount = stakingData.staked || 0;
                rewardsAmount = stakingData.rewards || 0;
                updateStakingDisplay();
            }
            
            // Start rewards calculation
            startRewardsCalculation();
        }

        function updateStakingDisplay() {
            stakedAmountDisplay.textContent = stakedAmount.toLocaleString();
            rewardsAmountDisplay.textContent = rewardsAmount.toFixed(4);
        }

        function startRewardsCalculation() {
            // Calculate rewards every second (69% APY)
            setInterval(() => {
                if (stakedAmount > 0) {
                    const secondlyReward = (stakedAmount * 0.69) / (365 * 24 * 60 * 60);
                    rewardsAmount += secondlyReward;
                    updateStakingDisplay();
                    
                    // Save to localStorage
                    localStorage.setItem('fluffi-staking', JSON.stringify({
                        staked: stakedAmount,
                        rewards: rewardsAmount
                    }));
                }
            }, 1000);
        }

        async function stakeTokens() {
            if (!isWalletConnected) {
                alert("🦊 Please connect your wallet first!");
                return;
            }

            const amount = parseFloat(stakeAmountInput.value);
            if (!amount || amount <= 0) {
                alert("🦊 Please enter a valid amount to stake!");
                return;
            }

            try {
                // In a real implementation, this would interact with the Cardano blockchain
                // For demo purposes, we'll simulate the staking transaction
                stakeBtn.textContent = "⏳ Staking...";
                stakeBtn.disabled = true;
                
                // Simulate transaction delay
                await new Promise(resolve => setTimeout(resolve, 2000));
                
                stakedAmount += amount;
                stakeAmountInput.value = "";
                updateStakingDisplay();
                
                stakeBtn.textContent = "🚀 Stake Tokens";
                stakeBtn.disabled = false;
                
                alert(`🎉 Successfully staked ${amount} FLUFF tokens! Your tokens are now earning 69% APY!`);
                
            } catch (err) {
                console.error("Staking failed:", err);
                alert("❌ Staking failed. Please try again.");
                stakeBtn.textContent = "🚀 Stake Tokens";
                stakeBtn.disabled = false;
            }
        }

        async function unstakeTokens() {
            if (!isWalletConnected) {
                alert("🦊 Please connect your wallet first!");
                return;
            }

            if (stakedAmount <= 0) {
                alert("🦊 You don't have any tokens staked!");
                return;
            }

            try {
                unstakeBtn.textContent = "⏳ Unstaking...";
                unstakeBtn.disabled = true;
                
                // Simulate transaction delay
                await new Promise(resolve => setTimeout(resolve, 2000));
                
                const totalToReturn = stakedAmount + rewardsAmount;
                stakedAmount = 0;
                rewardsAmount = 0;
                updateStakingDisplay();
                
                unstakeBtn.textContent = "💰 Unstake Tokens";
                unstakeBtn.disabled = false;
                
                alert(`🎉 Successfully unstaked all tokens! You received ${totalToReturn.toFixed(4)} FLUFF tokens (including rewards)!`);
                
            } catch (err) {
                console.error("Unstaking failed:", err);
                alert("❌ Unstaking failed. Please try again.");
                unstakeBtn.textContent = "💰 Unstake Tokens";
                unstakeBtn.disabled = false;
            }
        }

        // Event listeners
        connectBtn.addEventListener("click", connectWallet);
        stakeBtn.addEventListener("click", stakeTokens);
        unstakeBtn.addEventListener("click", unstakeTokens);

        // Add some nice hover effects
        connectBtn.addEventListener("mouseenter", function() {
            if (!this.disabled) {
                this.style.transform = "translateY(-2px)";
                this.style.boxShadow = "0 8px 25px rgba(245, 101, 0, 0.4)";
            }
        });

        connectBtn.addEventListener("mouseleave", function() {
            this.style.transform = "translateY(0)";
            this.style.boxShadow = "0 4px 15px rgba(0,0,0,0.1)";
        });

        console.log("🦊 FluffFi Staking Platform loaded successfully!");
        console.log("📊 Features: Eternal Wallet Integration, 69% APY Staking, Real-time Rewards");
    </script>

    <script defer="" src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" data-cf-beacon="{" rayid":"94a089a8ad878ea8","servertiming":{"name":{"cfextpri":true,"cfedge":true,"cforigin":true,"cfl4":true,"cfspeedbrain":true,"cfcachestatus":true}},"version":"2025.5.0","token":"dc79be98a7d9454985898a9490bd0402"}"="" crossorigin="anonymous"></script>
</body>
</html>