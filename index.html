<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FluffFi Staking</title>
    <link rel="icon" href="./images/3ed7b15d-65d7-4b9f-b73f-a3923e3817a4.png" type="image/png">
    <link rel="stylesheet" href="./css/index-C3j-O4ze.css">
    
    <style>
        /* Wallet connector styles */
        #wallet-connector {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 999999;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 15px;
            padding: 15px;
            box-shadow: 0 8px 32px rgba(31, 38, 135, 0.37);
            backdrop-filter: blur(8px);
            border: 1px solid rgba(255, 255, 255, 0.18);
            color: white;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            min-width: 250px;
        }

        #connect-btn {
            background: linear-gradient(45deg, #FF6B6B, #4ECDC4);
            border: none;
            color: white;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            width: 100%;
            margin-bottom: 10px;
            transition: all 0.3s ease;
            font-size: 14px;
        }

        #connect-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(255, 107, 107, 0.4);
        }

        #wallet-address {
            font-size: 12px;
            color: #E0E0E0;
            word-break: break-all;
            margin: 0;
        }

        /* Staking interface styles */
        .staking-interface {
            position: fixed;
            top: 120px;
            right: 20px;
            z-index: 999998;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(0, 0, 0, 0.1);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            min-width: 300px;
            backdrop-filter: blur(10px);
            display: none;
        }

        .staking-interface.active {
            display: block;
        }

        .staking-interface h3 {
            margin: 0 0 15px 0;
            color: #333;
            font-size: 18px;
            text-align: center;
        }

        .staking-input {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            margin-bottom: 15px;
            box-sizing: border-box;
        }

        .staking-input:focus {
            outline: none;
            border-color: #4ECDC4;
        }

        .stake-btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            border: none;
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            width: 100%;
            margin-bottom: 10px;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .stake-btn:hover:not(:disabled) {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        .stake-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .staking-stats {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
        }

        .stat-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .stat-label {
            color: #666;
        }

        .stat-value {
            color: #333;
            font-weight: bold;
        }

        .apy-highlight {
            color: #FF6B6B;
            font-size: 18px;
        }

        /* Loading spinner */
        .loading-spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #4ECDC4;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
            display: inline-block;
            margin-right: 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Responsive design */
        @media (max-width: 768px) {
            #wallet-connector {
                right: 10px;
                top: 10px;
                min-width: 200px;
            }

            .staking-interface {
                right: 10px;
                top: 100px;
                min-width: 250px;
            }
        }
    </style>
</head>
<body>
    <!-- React App Root -->
    <div id="root"></div>

    <!-- Wallet Connector -->
    <div id="wallet-connector">
        <button id="connect-btn">Connect Eternal Wallet</button>
        <p id="wallet-address"></p>
    </div>

    <!-- Staking Interface -->
    <div id="staking-interface" class="staking-interface">
        <h3>ðŸ¦Š FluffFi Staking</h3>
        
        <input type="number" id="stake-amount" class="staking-input" placeholder="Enter FLUFF amount to stake" min="0" step="0.01">
        
        <button id="stake-btn" class="stake-btn" disabled>
            <span id="stake-btn-text">Connect Wallet First</span>
        </button>
        
        <button id="unstake-btn" class="stake-btn" disabled>
            <span id="unstake-btn-text">Unstake All</span>
        </button>
        
        <div class="staking-stats">
            <div class="stat-item">
                <span class="stat-label">APY:</span>
                <span class="stat-value apy-highlight">69%</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">Your Staked:</span>
                <span class="stat-value" id="staked-amount">0 FLUFF</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">Pending Rewards:</span>
                <span class="stat-value" id="pending-rewards">0 FLUFF</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">Total Value:</span>
                <span class="stat-value" id="total-value">$0.00</span>
            </div>
        </div>
    </div>

    <!-- Original React App Script -->
    <script type="module" src="./js/index-DLdXciP5.js"></script>

    <script>
        // Wallet connection and staking functionality
        let walletConnected = false;
        let stakingData = {
            staked: 0,
            rewards: 0,
            lastUpdate: Date.now()
        };

        // Get DOM elements
        const connectBtn = document.getElementById("connect-btn");
        const walletAddressDisplay = document.getElementById("wallet-address");
        const stakingInterface = document.getElementById("staking-interface");
        const stakeAmountInput = document.getElementById("stake-amount");
        const stakeBtn = document.getElementById("stake-btn");
        const unstakeBtn = document.getElementById("unstake-btn");
        const stakeBtnText = document.getElementById("stake-btn-text");
        const unstakeBtnText = document.getElementById("unstake-btn-text");

        // Stats elements
        const stakedAmountEl = document.getElementById("staked-amount");
        const pendingRewardsEl = document.getElementById("pending-rewards");
        const totalValueEl = document.getElementById("total-value");

        // Update staking stats display
        function updateStakingStats() {
            if (!walletConnected) return;

            // Calculate rewards (69% APY)
            const now = Date.now();
            const timeDiff = (now - stakingData.lastUpdate) / 1000; // seconds
            const rewardRate = 0.69 / (365 * 24 * 3600); // APY to per-second rate
            stakingData.rewards += stakingData.staked * rewardRate * timeDiff;
            stakingData.lastUpdate = now;

            // Update display
            stakedAmountEl.textContent = `${stakingData.staked.toFixed(2)} FLUFF`;
            pendingRewardsEl.textContent = `${stakingData.rewards.toFixed(6)} FLUFF`;
            
            // Mock price calculation ($0.15 per FLUFF)
            const totalTokens = stakingData.staked + stakingData.rewards;
            const totalValue = totalTokens * 0.15;
            totalValueEl.textContent = `$${totalValue.toFixed(2)}`;
        }

        // Connect wallet function
        async function connectWallet() {
            if (!window.cardano || !window.cardano.eternl) {
                // Simulate wallet connection for demo
                walletConnected = true;
                const mockAddress = "addr1qx..." + Math.random().toString(36).substr(2, 20);
                walletAddressDisplay.textContent = `Connected: ${mockAddress}`;
                connectBtn.textContent = "âœ… Wallet Connected";
                connectBtn.style.background = "linear-gradient(45deg, #4ECDC4, #44A08D)";
                
                // Show staking interface
                stakingInterface.classList.add("active");
                
                // Enable staking buttons
                stakeBtn.disabled = false;
                unstakeBtn.disabled = false;
                stakeBtnText.textContent = "Stake FLUFF";
                unstakeBtnText.textContent = "Unstake All";
                
                // Start updating rewards
                setInterval(updateStakingStats, 1000);
                return;
            }

            try {
                const api = await window.cardano.eternl.enable();
                const addresses = await api.getUsedAddresses();
                const firstAddress = addresses[0];

                walletConnected = true;
                walletAddressDisplay.textContent = `Connected: ${firstAddress.slice(0, 20)}...`;
                connectBtn.textContent = "âœ… Wallet Connected";
                connectBtn.style.background = "linear-gradient(45deg, #4ECDC4, #44A08D)";
                
                // Show staking interface
                stakingInterface.classList.add("active");
                
                // Enable staking buttons
                stakeBtn.disabled = false;
                unstakeBtn.disabled = false;
                stakeBtnText.textContent = "Stake FLUFF";
                unstakeBtnText.textContent = "Unstake All";
                
                // Start updating rewards
                setInterval(updateStakingStats, 1000);
                
            } catch (err) {
                console.error("Wallet connection failed", err);
                walletAddressDisplay.textContent = "Failed to connect wallet.";
            }
        }

        // Stake function
        function stakeTokens() {
            if (!walletConnected) return;

            const amount = parseFloat(stakeAmountInput.value);
            if (isNaN(amount) || amount <= 0) return;

            // Simulate staking transaction
            stakeBtnText.innerHTML = '<span class="loading-spinner"></span>Staking...';
            stakeBtn.disabled = true;

            setTimeout(() => {
                stakingData.staked += amount;
                stakingData.lastUpdate = Date.now();
                stakeAmountInput.value = '';
                
                stakeBtnText.textContent = "Stake FLUFF";
                stakeBtn.disabled = false;
                
                updateStakingStats();
            }, 2000);
        }

        // Unstake function
        function unstakeTokens() {
            if (!walletConnected || stakingData.staked === 0) return;

            // Simulate unstaking transaction
            unstakeBtnText.innerHTML = '<span class="loading-spinner"></span>Unstaking...';
            unstakeBtn.disabled = true;

            setTimeout(() => {
                const totalAmount = stakingData.staked + stakingData.rewards;
                stakingData.staked = 0;
                stakingData.rewards = 0;
                stakingData.lastUpdate = Date.now();
                
                unstakeBtnText.textContent = "Unstake All";
                unstakeBtn.disabled = false;
                
                updateStakingStats();
            }, 2000);
        }

        // Event listeners
        connectBtn.addEventListener("click", connectWallet);
        stakeBtn.addEventListener("click", stakeTokens);
        unstakeBtn.addEventListener("click", unstakeTokens);

        // Allow enter key to stake
        stakeAmountInput.addEventListener("keypress", function(e) {
            if (e.key === "Enter" && !stakeBtn.disabled) {
                stakeTokens();
            }
        });

        // Initialize display
        updateStakingStats();
    </script>
</body>
</html>