<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FluffFi Staking - Stake Your $FLUFF on Cardano</title>
    <meta name="description" content="Stake your FluffFi tokens and earn rewards! Join the fluffiest staking revolution on Cardano blockchain.">
    <meta name="author" content="FluffFi Team">
    <link rel="icon" href="images/3ed7b15d-65d7-4b9f-b73f-a3923e3817a4.png" type="image/png">

    <meta property="og:title" content="FluffFi Staking - Stake Your $FLUFF Tokens">
    <meta property="og:description" content="Stake your FluffFi tokens and earn rewards! 🦊 Join the fluffiest staking revolution on Cardano blockchain.">
    <meta property="og:image" content="https://shelby69699.github.io/fluffi/images/3ed7b15d-65d7-4b9f-b73f-a3923e3817a4.png">
    <meta property="og:url" content="https://shelby69699.github.io/fluffi/">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="FluffFi Staking">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@FluffFiOfficial">
    <meta name="twitter:title" content="FluffFi Staking - Stake Your $FLUFF Tokens">
    <meta name="twitter:description" content="Stake your FluffFi tokens and earn rewards! 🦊 Join the fluffiest staking revolution on Cardano blockchain.">
    <meta name="twitter:image" content="https://shelby69699.github.io/fluffi/images/3ed7b15d-65d7-4b9f-b73f-a3923e3817a4.png">

    <!-- Add base tag for GitHub Pages routing -->
    <base href="/fluffi/">
    
    <link rel="stylesheet" href="css/index-C3j-O4ze.css">
    
    <style>
        /* Override and ensure proper stacking */
        #wallet-connector {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 999999;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 15px;
            padding: 15px;
            box-shadow: 0 8px 32px rgba(31, 38, 135, 0.37);
            backdrop-filter: blur(8px);
            border: 1px solid rgba(255, 255, 255, 0.18);
            color: white;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            min-width: 250px;
        }

        #connect-btn {
            background: linear-gradient(45deg, #FF6B6B, #4ECDC4);
            border: none;
            color: white;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            width: 100%;
            margin-bottom: 10px;
            transition: all 0.3s ease;
            font-size: 14px;
        }

        #connect-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(255, 107, 107, 0.4);
        }

        #wallet-address {
            font-size: 12px;
            color: #E0E0E0;
            word-break: break-all;
            margin: 0;
        }

        .staking-interface {
            position: fixed;
            top: 120px;
            right: 20px;
            z-index: 999998;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(0, 0, 0, 0.1);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            min-width: 300px;
            backdrop-filter: blur(10px);
            display: none; /* Initially hidden */
        }

        .staking-interface.active {
            display: block;
        }

        .staking-interface h3 {
            margin: 0 0 15px 0;
            color: #333;
            font-size: 18px;
            text-align: center;
        }

        .staking-input {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            margin-bottom: 15px;
            box-sizing: border-box;
        }

        .staking-input:focus {
            outline: none;
            border-color: #4ECDC4;
        }

        .stake-btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            border: none;
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            width: 100%;
            margin-bottom: 10px;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .stake-btn:hover:not(:disabled) {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        .stake-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .staking-stats {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
        }

        .stat-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .stat-label {
            color: #666;
        }

        .stat-value {
            color: #333;
            font-weight: bold;
        }

        .apy-highlight {
            color: #FF6B6B;
            font-size: 18px;
        }

        /* Ensure React app doesn't interfere */
        #root {
            position: relative;
            z-index: 1;
        }

        /* Loading spinner for better UX */
        .loading-spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #4ECDC4;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
            display: inline-block;
            margin-right: 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Hide React 404 and show custom content */
        .react-fallback {
            display: none;
        }

        .react-working {
            display: block !important;
        }

        /* Custom fallback content styles */
        .fluffi-main {
            min-height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            color: white;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            padding: 40px 20px;
        }

        .fluffi-logo {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        .fluffi-title {
            font-size: 3.5rem;
            font-weight: bold;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .fluffi-subtitle {
            font-size: 1.5rem;
            margin-bottom: 40px;
            opacity: 0.9;
        }

        .fluffi-features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
            max-width: 800px;
            width: 100%;
            margin-bottom: 40px;
        }

        .feature-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: transform 0.3s ease;
        }

        .feature-card:hover {
            transform: translateY(-5px);
        }

        .feature-icon {
            font-size: 2.5rem;
            margin-bottom: 15px;
        }

        .feature-title {
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .feature-desc {
            opacity: 0.8;
            line-height: 1.5;
        }

        .cta-button {
            background: linear-gradient(45deg, #FF6B6B, #4ECDC4);
            border: none;
            color: white;
            padding: 15px 40px;
            border-radius: 30px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            margin-top: 20px;
        }

        .cta-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(255, 107, 107, 0.4);
        }

        .stats-banner {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            margin-top: 40px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 20px;
            text-align: center;
        }

        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            color: #FF6B6B;
        }

        .stat-label {
            font-size: 0.9rem;
            opacity: 0.8;
        }
    </style>
</head>
<body>
    <!-- GitHub Pages Router Fix -->
    <script>
        // Fix for GitHub Pages routing
        (function() {
            var redirect = sessionStorage.redirect;
            delete sessionStorage.redirect;
            if (redirect && redirect != location.href) {
                history.replaceState(null, null, redirect);
            }
        })();

        // Set the correct base for the React app
        if (window.location.hostname === 'shelby69699.github.io') {
            // GitHub Pages environment
            window.__REACT_BASE_PATH__ = '/fluffi/';
        } else {
            // Local development
            window.__REACT_BASE_PATH__ = '/';
        }
    </script>

    <!-- React App Root -->
    <div id="root">
        <!-- Fallback content while React loads or if it fails -->
        <div class="fluffi-main">
            <img src="images/3ed7b15d-65d7-4b9f-b73f-a3923e3817a4.png" alt="FluffFi Logo" class="fluffi-logo">
            
            <h1 class="fluffi-title">🦊 FluffFi</h1>
            <p class="fluffi-subtitle">The Fluffiest Token on Cardano</p>
            
            <div class="fluffi-features">
                <div class="feature-card">
                    <div class="feature-icon">🏦</div>
                    <h3 class="feature-title">Staking Platform</h3>
                    <p class="feature-desc">Earn 69% APY by staking your FLUFF tokens with our advanced staking protocol.</p>
                </div>
                
                <div class="feature-card">
                    <div class="feature-icon">⚡</div>
                    <h3 class="feature-title">Fast & Secure</h3>
                    <p class="feature-desc">Built on Cardano blockchain for lightning-fast transactions and maximum security.</p>
                </div>
                
                <div class="feature-card">
                    <div class="feature-icon">🎯</div>
                    <h3 class="feature-title">Community Driven</h3>
                    <p class="feature-desc">Governed by the community, for the community. Your voice matters in FluffFi's future.</p>
                </div>
            </div>

            <div class="stats-banner">
                <div class="stats-grid">
                    <div>
                        <div class="stat-number">69%</div>
                        <div class="stat-label">APY</div>
                    </div>
                    <div>
                        <div class="stat-number">$0.15</div>
                        <div class="stat-label">Token Price</div>
                    </div>
                    <div>
                        <div class="stat-number">1M+</div>
                        <div class="stat-label">Total Supply</div>
                    </div>
                    <div>
                        <div class="stat-number">24/7</div>
                        <div class="stat-label">Staking</div>
                    </div>
                </div>
            </div>
            
            <a href="#staking" class="cta-button" onclick="document.getElementById('connect-btn').click(); return false;">
                🚀 Start Staking Now
            </a>
        </div>
    </div>

    <!-- Wallet Connector -->
    <div id="wallet-connector">
        <button id="connect-btn">Connect Eternal Wallet</button>
        <p id="wallet-address"></p>
    </div>

    <!-- Staking Interface -->
    <div id="staking-interface" class="staking-interface">
        <h3>🦊 FluffFi Staking</h3>
        
        <input type="number" id="stake-amount" class="staking-input" placeholder="Enter FLUFF amount to stake" min="0" step="0.01">
        
        <button id="stake-btn" class="stake-btn" disabled>
            <span id="stake-btn-text">Connect Wallet First</span>
        </button>
        
        <button id="unstake-btn" class="stake-btn" disabled>
            <span id="unstake-btn-text">Unstake All</span>
        </button>
        
        <div class="staking-stats">
            <div class="stat-item">
                <span class="stat-label">APY:</span>
                <span class="stat-value apy-highlight">69%</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">Your Staked:</span>
                <span class="stat-value" id="staked-amount">0 FLUFF</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">Pending Rewards:</span>
                <span class="stat-value" id="pending-rewards">0 FLUFF</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">Total Value:</span>
                <span class="stat-value" id="total-value">$0.00</span>
            </div>
        </div>
    </div>

    <!-- Load React after our setup -->
    <script type="module" src="js/index-DLdXciP5.js"></script>

    <script>
        // Wallet connection and staking functionality
        let walletConnected = false;
        let stakingData = {
            staked: 0,
            rewards: 0,
            lastUpdate: Date.now()
        };

        // Get DOM elements
        const connectBtn = document.getElementById("connect-btn");
        const walletAddressDisplay = document.getElementById("wallet-address");
        const stakingInterface = document.getElementById("staking-interface");
        const stakeAmountInput = document.getElementById("stake-amount");
        const stakeBtn = document.getElementById("stake-btn");
        const unstakeBtn = document.getElementById("unstake-btn");
        const stakeBtnText = document.getElementById("stake-btn-text");
        const unstakeBtnText = document.getElementById("unstake-btn-text");

        // Stats elements
        const stakedAmountEl = document.getElementById("staked-amount");
        const pendingRewardsEl = document.getElementById("pending-rewards");
        const totalValueEl = document.getElementById("total-value");

        // Check if React loaded successfully after 3 seconds
        setTimeout(() => {
            const rootElement = document.getElementById('root');
            const hasReactContent = rootElement && (
                rootElement.children.length > 1 || 
                (rootElement.children.length === 1 && !rootElement.children[0].classList.contains('fluffi-main'))
            );
            
            if (!hasReactContent) {
                console.log('🦊 React app fallback mode - showing custom FluffFi interface');
                // Keep the fallback content visible
            } else {
                console.log('✅ React app loaded successfully');
                // React loaded, can hide fallback if needed
            }
        }, 3000);

        // Update staking stats display
        function updateStakingStats() {
            if (!walletConnected) return;

            // Calculate rewards (69% APY)
            const now = Date.now();
            const timeDiff = (now - stakingData.lastUpdate) / 1000; // seconds
            const rewardRate = 0.69 / (365 * 24 * 3600); // APY to per-second rate
            stakingData.rewards += stakingData.staked * rewardRate * timeDiff;
            stakingData.lastUpdate = now;

            // Update display
            stakedAmountEl.textContent = `${stakingData.staked.toFixed(2)} FLUFF`;
            pendingRewardsEl.textContent = `${stakingData.rewards.toFixed(6)} FLUFF`;
            
            // Mock price calculation ($0.15 per FLUFF)
            const totalTokens = stakingData.staked + stakingData.rewards;
            const totalValue = totalTokens * 0.15;
            totalValueEl.textContent = `$${totalValue.toFixed(2)}`;
        }

        // Connect wallet function
        async function connectWallet() {
            if (!window.cardano || !window.cardano.eternl) {
                alert("Eternal wallet not found. Please install it from eternalwallet.io.\n\nFor demo purposes, we'll simulate a connection!");
                
                // Simulate wallet connection for demo
                walletConnected = true;
                const mockAddress = "addr1qx..." + Math.random().toString(36).substr(2, 20);
                walletAddressDisplay.textContent = `Connected: ${mockAddress}`;
                connectBtn.textContent = "✅ Wallet Connected";
                connectBtn.style.background = "linear-gradient(45deg, #4ECDC4, #44A08D)";
                
                // Show staking interface
                stakingInterface.classList.add("active");
                
                // Enable staking buttons
                stakeBtn.disabled = false;
                unstakeBtn.disabled = false;
                stakeBtnText.textContent = "Stake FLUFF";
                unstakeBtnText.textContent = "Unstake All";
                
                // Start updating rewards
                setInterval(updateStakingStats, 1000);
                return;
            }

            try {
                const api = await window.cardano.eternl.enable();
                const addresses = await api.getUsedAddresses();
                const firstAddress = addresses[0];

                walletConnected = true;
                walletAddressDisplay.textContent = `Connected: ${firstAddress.slice(0, 20)}...`;
                connectBtn.textContent = "✅ Wallet Connected";
                connectBtn.style.background = "linear-gradient(45deg, #4ECDC4, #44A08D)";
                
                // Show staking interface
                stakingInterface.classList.add("active");
                
                // Enable staking buttons
                stakeBtn.disabled = false;
                unstakeBtn.disabled = false;
                stakeBtnText.textContent = "Stake FLUFF";
                unstakeBtnText.textContent = "Unstake All";
                
                // Start updating rewards
                setInterval(updateStakingStats, 1000);
                
            } catch (err) {
                console.error("Wallet connection failed", err);
                walletAddressDisplay.textContent = "Failed to connect wallet.";
            }
        }

        // Stake function
        function stakeTokens() {
            if (!walletConnected) {
                alert("Please connect your wallet first!");
                return;
            }

            const amount = parseFloat(stakeAmountInput.value);
            if (isNaN(amount) || amount <= 0) {
                alert("Please enter a valid amount to stake!");
                return;
            }

            // Simulate staking transaction
            stakeBtnText.innerHTML = '<span class="loading-spinner"></span>Staking...';
            stakeBtn.disabled = true;

            setTimeout(() => {
                stakingData.staked += amount;
                stakingData.lastUpdate = Date.now();
                stakeAmountInput.value = '';
                
                stakeBtnText.textContent = "Stake FLUFF";
                stakeBtn.disabled = false;
                
                updateStakingStats();
                
                alert(`Successfully staked ${amount} FLUFF! 🎉\nYou're now earning 69% APY!`);
            }, 2000);
        }

        // Unstake function
        function unstakeTokens() {
            if (!walletConnected || stakingData.staked === 0) {
                alert("No tokens to unstake!");
                return;
            }

            // Simulate unstaking transaction
            unstakeBtnText.innerHTML = '<span class="loading-spinner"></span>Unstaking...';
            unstakeBtn.disabled = true;

            setTimeout(() => {
                const totalAmount = stakingData.staked + stakingData.rewards;
                stakingData.staked = 0;
                stakingData.rewards = 0;
                stakingData.lastUpdate = Date.now();
                
                unstakeBtnText.textContent = "Unstake All";
                unstakeBtn.disabled = false;
                
                updateStakingStats();
                
                alert(`Successfully unstaked ${totalAmount.toFixed(6)} FLUFF! 💰`);
            }, 2000);
        }

        // Event listeners
        connectBtn.addEventListener("click", connectWallet);
        stakeBtn.addEventListener("click", stakeTokens);
        unstakeBtn.addEventListener("click", unstakeTokens);

        // Allow enter key to stake
        stakeAmountInput.addEventListener("keypress", function(e) {
            if (e.key === "Enter" && !stakeBtn.disabled) {
                stakeTokens();
            }
        });

        // Initialize display
        updateStakingStats();

        // Add some visual flair
        console.log(`
🦊 FluffFi Staking Platform 🦊
================================
Welcome to the fluffiest staking experience on Cardano!

💰 Features:
- 69% APY (because why not?)
- Real-time rewards calculation
- Instant staking/unstaking
- Beautiful UI/UX

🚀 Connect your Eternal wallet to get started!
        `);
    </script>
</body>
</html>